USE [DOGUKANSSIS]
GO

/****** Object:  StoredProcedure [dbo].[LAYERSGOREVNO]    Script Date: 23.03.2024 21:56:59 ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO







CREATE PROCEDURE [dbo].[LAYERSGOREVNO]
    @GorevNo NVARCHAR(255)
AS
BEGIN

SELECT 
		Q1.ID,
		Q1.POS_NR,
		ENG.ENG,
		Q1.BIRIM,
		Q1.BIRIMFIYAT,
		Q1.HESAPLANMISFIYAT




 FROM  
(
	SELECT *, ROW_NUMBER() OVER (ORDER BY (SELECT NULL)) AS RN
  FROM [dbo].[KATMANLAR_DG_SSIS]
  ) Q1

INNER JOIN [dbo].[ALFAK_ENG_ITEM]  AS ENG
ON
Q1.BOM_PRODUKT=ENG.Numara

WHERE Q1.ID IN 


(
			SELECT CAST( VALUE AS INT) AS VALUE 
			FROM
			SplitStringDG(
@GorevNo,','))


ORDER BY Q1.RN
END
GO


